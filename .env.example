# Environment Configuration Template
# Copy this file to .env and customize for your environment

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
# ClickHouse database connection settings
# These are used by all microservices to connect to the database

CLICKHOUSE_HOST=clickhouse-server
CLICKHOUSE_USER=myuser
CLICKHOUSE_PASSWORD=mypassword
CLICKHOUSE_DB=mydatabase

# Production example:
# CLICKHOUSE_HOST=clickhouse-prod.your-domain.com
# CLICKHOUSE_USER=prod_user
# CLICKHOUSE_PASSWORD=super_secure_password_here
# CLICKHOUSE_DB=production_database

# =============================================================================
# MARKET POLLER CONFIGURATION
# =============================================================================
# Background service that fetches market data from external APIs

# Comma-separated list of financial instruments to monitor
# Format: EXCHANGE_TYPE|INSTRUMENT_ID
POLLER_INSTRUMENTS=NSE_EQ|INE009A01021,BSE_EQ|500325

# External market data API base URL
UPSTOX_BASE_URL=https://api.upstox.com

# Internal service URLs for data forwarding
# These should match the actual service hostnames and ports
POLLER_INGEST_MARKET_URL=http://ingest-marketdata:8081/ingest/marketdata
POLLER_INGEST_EVENTS_URL=http://ingest-events:8080/ingest/events

# Polling frequency - how often to fetch market data
# Examples: 30s, 1m, 2m30s
POLLER_INTERVAL=30s

# Market timezone and trading hours
POLLER_TIMEZONE=Asia/Kolkata
POLLER_START_TIME=09:15
POLLER_END_TIME=15:30

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================
# Control logging behavior across all services

# Log level: DEBUG, INFO, WARN, ERROR
LOG_LEVEL=INFO

# Log format: json, text, pretty
LOG_FORMAT=json

# Enable debug mode for development
# DEBUG=true

# =============================================================================
# SERVICE CONFIGURATION
# =============================================================================
# HTTP server settings for all microservices

# Request timeout for HTTP handlers
HTTP_TIMEOUT=30s

# Maximum request body size (for ingestion services)
MAX_REQUEST_SIZE=10MB

# Enable request logging
LOG_REQUESTS=true

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================
# Security-related settings (uncomment for production)

# JWT secret for authentication (generate a strong secret)
# JWT_SECRET=your-super-secret-jwt-key-here

# API keys for external services
# UPSTOX_API_KEY=your-upstox-api-key
# EXTERNAL_API_TOKEN=your-external-api-token

# CORS settings for web clients
# CORS_ORIGINS=https://your-frontend.com,https://your-dashboard.com
# CORS_METHODS=GET,POST,PUT,DELETE
# CORS_HEADERS=Content-Type,Authorization

# =============================================================================
# PERFORMANCE CONFIGURATION
# =============================================================================
# Settings to optimize performance

# Database connection pool settings
DB_MAX_OPEN_CONNS=50
DB_MAX_IDLE_CONNS=5
DB_CONN_MAX_LIFETIME=1h

# HTTP client timeouts
HTTP_CLIENT_TIMEOUT=10s
HTTP_CLIENT_KEEP_ALIVE=30s

# Batch processing settings
BATCH_SIZE=1000
BATCH_TIMEOUT=5s

# =============================================================================
# MONITORING & OBSERVABILITY
# =============================================================================
# Metrics and monitoring configuration

# Enable Prometheus metrics endpoint
ENABLE_METRICS=true
METRICS_PORT=9090

# Health check configuration
HEALTH_CHECK_INTERVAL=30s
HEALTH_CHECK_TIMEOUT=5s

# Distributed tracing (uncomment to enable)
# JAEGER_ENDPOINT=http://jaeger:14268/api/traces
# JAEGER_SERVICE_NAME=go-microservices

# =============================================================================
# EXTERNAL INTEGRATIONS
# =============================================================================
# Configuration for external services and APIs

# Email service (for notifications)
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_USERNAME=your-email@gmail.com
# SMTP_PASSWORD=your-app-password

# Redis cache (for performance optimization)
# REDIS_URL=redis://redis:6379/0
# REDIS_PASSWORD=your-redis-password

# Message queue (for async processing)
# KAFKA_BROKERS=kafka:9092
# KAFKA_TOPIC_EVENTS=events
# KAFKA_TOPIC_MARKET_DATA=market-data

# =============================================================================
# DEVELOPMENT SETTINGS
# =============================================================================
# Settings useful during development (remove in production)

# Auto-reload services on code changes
# DEV_AUTO_RELOAD=true

# Mock external APIs for testing
# MOCK_EXTERNAL_APIS=true

# Seed database with test data
# SEED_TEST_DATA=true

# =============================================================================
# ENVIRONMENT-SPECIFIC OVERRIDES
# =============================================================================
# Uncomment sections based on your deployment environment

# LOCAL DEVELOPMENT
# =================
# CLICKHOUSE_HOST=localhost
# LOG_LEVEL=DEBUG
# DEBUG=true
# MOCK_EXTERNAL_APIS=true

# STAGING ENVIRONMENT
# ===================
# CLICKHOUSE_HOST=clickhouse-staging.internal
# CLICKHOUSE_DB=staging_database
# LOG_LEVEL=INFO
# ENABLE_METRICS=true

# PRODUCTION ENVIRONMENT
# ======================
# CLICKHOUSE_HOST=clickhouse-prod.internal
# CLICKHOUSE_DB=production_database
# LOG_LEVEL=WARN
# ENABLE_METRICS=true
# HTTP_TIMEOUT=10s
# CORS_ORIGINS=https://your-production-domain.com

# =============================================================================
# SCALING CONFIGURATION
# =============================================================================
# Settings for handling high load

# Rate limiting (requests per minute per IP)
# RATE_LIMIT_REQUESTS=1000
# RATE_LIMIT_WINDOW=1m

# Circuit breaker settings
# CIRCUIT_BREAKER_THRESHOLD=5
# CIRCUIT_BREAKER_TIMEOUT=30s

# Load balancing (if using multiple instances)
# LOAD_BALANCER_STRATEGY=round_robin
# HEALTH_CHECK_PATH=/health

# =============================================================================
# BACKUP AND RECOVERY
# =============================================================================
# Data backup and disaster recovery settings

# Backup configuration
# BACKUP_ENABLED=true
# BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM
# BACKUP_RETENTION_DAYS=30
# BACKUP_STORAGE_PATH=/backups

# =============================================================================
# CUSTOM APPLICATION SETTINGS
# =============================================================================
# Add your own application-specific configuration here

# Business logic settings
# MIN_ORDER_AMOUNT=100
# MAX_ORDER_AMOUNT=1000000
# DEFAULT_CURRENCY=USD

# Feature flags
# ENABLE_NEW_FEATURE=false
# EXPERIMENTAL_MODE=false

# Regional settings
# DEFAULT_LOCALE=en_US
# SUPPORTED_CURRENCIES=USD,EUR,INR

# =============================================================================
# DOCKER COMPOSE OVERRIDES
# =============================================================================
# These variables are used by docker-compose.yml

# Service replica counts (for scaling)
INGEST_EVENTS_REPLICAS=1
QUERY_EVENTS_REPLICAS=2
INGEST_MARKETDATA_REPLICAS=1
QUERY_MARKETDATA_REPLICAS=2

# Resource limits
CLICKHOUSE_MEMORY=4g
SERVICE_MEMORY=512m
SERVICE_CPU_LIMIT=1.0

# Volume mounts (for development)
# MOUNT_SOURCE_CODE=./:/app

# =============================================================================
# VALIDATION AND CONSTRAINTS
# =============================================================================
# Data validation settings

# Input validation
MAX_EVENT_MESSAGE_LENGTH=1000
MAX_CONTEXT_FIELDS=50
ALLOWED_LOG_LEVELS=DEBUG,INFO,WARN,ERROR

# API rate limits
API_RATE_LIMIT_PER_HOUR=10000
API_BURST_LIMIT=100

# Data retention policies
EVENT_RETENTION_DAYS=365
MARKET_DATA_RETENTION_DAYS=2555  # 7 years for financial data

# =============================================================================
# DEBUGGING AND TROUBLESHOOTING
# =============================================================================
# Settings to help with debugging issues

# Enable SQL query logging
# LOG_SQL_QUERIES=true

# Enable HTTP request/response logging
# LOG_HTTP_DETAILS=true

# Enable performance profiling
# ENABLE_PPROF=true
# PPROF_PORT=6060

# Memory profiling
# ENABLE_MEMORY_PROFILING=true
# MEMORY_PROFILE_RATE=1

# CPU profiling
# ENABLE_CPU_PROFILING=true
# CPU_PROFILE_DURATION=30s

# =============================================================================
# NOTES FOR DEVELOPERS
# =============================================================================

# Environment Variable Naming Convention:
# - Use UPPER_CASE with underscores
# - Group related variables with common prefixes
# - Keep names descriptive but concise

# Security Best Practices:
# - Never commit real passwords or API keys
# - Use environment-specific .env files
# - Rotate secrets regularly
# - Use secret management systems in production

# Performance Tips:
# - Adjust connection pool sizes based on load
# - Monitor resource usage and adjust limits
# - Use caching for frequently accessed data
# - Implement circuit breakers for external dependencies

# Debugging Tips:
# - Start with LOG_LEVEL=DEBUG for troubleshooting
# - Enable detailed logging temporarily
# - Use health checks to monitor service status
# - Monitor database connection health

# Production Checklist:
# □ Change all default passwords
# □ Set appropriate resource limits
# □ Enable monitoring and alerting
# □ Configure backup strategies
# □ Set up log aggregation
# □ Implement security headers
# □ Configure rate limiting
# □ Set up health checks
# □ Document environment-specific settings
# □ Test disaster recovery procedures